### pre_process.py
import pandas as pd
import datetime
import socket
import struct

# Function to convert hex timestamp to datetime
def hex_to_datetime(hex_ts):
    return datetime.datetime.utcfromtimestamp(int(hex_ts, 16))

# Function to convert hex IP to string IP
def hex_to_ip(hex_ip):
    return socket.inet_ntoa(struct.pack('!L', int(hex_ip, 16)))

# Function to convert hex to int
def hex_to_int(hex_val):
    return int(hex_val, 16)

# Function to parse a row
def parse_row(row):
    parts = row.split()
    return {
        'ts': hex_to_datetime(parts[0][:-1]),
        'pr': 'tcp',
        'src_ip': hex_to_ip(parts[2].split('.')[0]),
        'src_pt': hex_to_int(parts[2].split('.')[1]),
        'dst_ip': hex_to_ip(parts[3].split('.')[0]),
        'dst_pt': hex_to_int(parts[3].split('.')[1]),
        'cnt': hex_to_int(parts[4]),
        'bts': hex_to_int(parts[5]),
        'flgs': parts[6]
    }

# Read the file
with open('netflows.txt', 'r') as f:
    data = [parse_row(row) for row in f]

# Convert the data to a DataFrame
df = pd.DataFrame(data)

### add_dst_subnet.py

import pandas as pd
import ipaddress

# Define the subnets
subnets = [ipaddress.ip_network('128.61.0.0/16'), ipaddress.ip_network('130.207.0.0/16'), 
           ipaddress.ip_network('143.215.0.0/16'), ipaddress.ip_network('192.76.181.0/24')]

# Function to assign each IP to a subnet
def assign_subnet(ip):
    for subnet in subnets:
        if ipaddress.ip_address(ip) in subnet:
            return str(subnet)
    return 'other'

# Assign each destination IP to a subnet
df['dst_subnet'] = df['dst_ip'].apply(assign_subnet)


### features.py

import pandas as pd
import numpy as np

# Convert the timestamp to a datetime object
df['ts'] = pd.to_datetime(df['ts'])

# Ensure 'ts' is the DataFrame's index
df.set_index('ts', inplace=True)

# Add small random noise to 'ts' column to ensure all timestamps are unique
df.index += pd.to_timedelta(np.random.randint(0, 1000), unit='ms')

# Calculate the number of connections an IP makes per minute in a separate DataFrame
num_connections_per_minute = df.groupby('src_ip').resample('1T')['dst_ip'].count().reset_index()
num_connections_per_minute.columns = ['src_ip', 'ts', 'num_connections_per_minute']

# Merge the new DataFrame with the original DataFrame
df = pd.merge(df.reset_index(), num_connections_per_minute, on=['src_ip', 'ts'], how='left')

# Fill NaN values with 0
df['num_connections_per_minute'].fillna(0, inplace=True)

# Ensure 'ts' is the DataFrame's index again
df.set_index('ts', inplace=True)

# Continue with the rest of your code...

# Calculate the number of unique servers an IP connects to
df['num_unique_servers'] = df.groupby('src_ip')['dst_ip'].transform('nunique')

# Calculate the total bytes transferred by an IP
df['total_bytes_transferred'] = df.groupby('src_ip')['bts'].transform('sum')

# Calculate the average number of packets exchanged per session for each pair of source and destination IPs
df['avg_packets_per_session'] = df.groupby(['src_ip', 'dst_ip'])['cnt'].transform('mean')

# Reset the index
df.reset_index(inplace=True)

# Calculate the number of SYN flags sent by an IP
df['num_syn_flags'] = df[df['flgs'].str.contains('S')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of ACK flags sent by an IP
df['num_ack_flags'] = df[df['flgs'].str.contains('A')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of RST flags sent by an IP
df['num_rst_flags'] = df[df['flgs'].str.contains('R')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of FIN flags sent by an IP
df['num_fin_flags'] = df[df['flgs'].str.contains('F')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of connections an IP makes to the same server
df['num_connections_to_same_server'] = df.groupby(['src_ip', 'dst_ip']).transform('size')

# Calculate the number of connections an IP makes to different subnets
df['num_connections_to_diff_subnets'] = df.groupby('src_ip')['dst_subnet'].transform('nunique')

# Calculate the number of connections an IP makes after network admins have gone home for the day
df['num_connections_after_hours'] = df[df['ts'].dt.hour.isin(range(18, 24))].groupby('src_ip')['dst_ip'].transform('count')

# Fill NaN values with 0
df.fillna(0, inplace=True)

# Set 'ts' as the index again
df.set_index('ts', inplace=True)

weights =[   [   [   0.34202051162719727,
            -0.3236350119113922,
            0.030173122882843018,
            -0.09289920330047607,
            -0.11818751692771912,
            0.03706243634223938,
            -0.2345043569803238,
            0.0714363157749176,
            -0.16968509554862976,
            -0.2602001130580902,
            0.3120764493942261,
            -0.02873876690864563,
            -0.1337236911058426,
            -0.14261256158351898,
            -0.3280879259109497,
            0.27864915132522583,
            -0.21275721490383148,
            0.35134685039520264,
            -0.22975832223892212,
            -0.17832496762275696,
            0.27592742443084717,
            0.14132395386695862,
            -0.2430294007062912,
            -0.19871416687965393,
            0.010458260774612427,
            -0.20311392843723297,
            0.022117793560028076,
            -0.010203450918197632,
            0.10319143533706665,
            0.047972172498703,
            -0.11759334802627563,
            0.21498090028762817],
        [   -0.40060824155807495,
            -0.2689703702926636,
            -0.18313643336296082,
            -0.8103294968605042,
            0.06009066104888916,
            -0.14746136963367462,
            0.30154284834861755,
            -0.3889347314834595,
            -0.3954574763774872,
            -0.6185808181762695,
            0.08934546262025833,
            0.003439755877479911,
            -0.12311703711748123,
            0.09112049639225006,
            -0.14430685341358185,
            -0.21067853271961212,
            -0.4740862250328064,
            -0.041579388082027435,
            0.4669955372810364,
            0.06355801224708557,
            -0.06207441911101341,
            -0.1906949132680893,
            -0.05119342729449272,
            -0.4327673017978668,
            -0.4460659921169281,
            -0.04044917970895767,
            -0.6722562909126282,
            -0.46469154953956604,
            -0.03602438047528267,
            0.06957503408193588,
            -0.31998708844184875,
            -0.007117731962352991],
        [   -0.20830124616622925,
            -0.15468110144138336,
            0.012534389272332191,
            0.10574156790971756,
            0.307731956243515,
            0.12036607414484024,
            0.24023723602294922,
            0.2425604611635208,
            -0.17934982478618622,
            0.05537990853190422,
            0.002297432627528906,
            0.33009442687034607,
            0.3406201899051666,
            0.3492690920829773,
            0.218794584274292,
            0.3797076940536499,
            -0.2976900339126587,
            -0.11871420592069626,
            -0.299209862947464,
            0.20165467262268066,
            0.4219169616699219,
            -0.2825804650783539,
            -0.2870466113090515,
            0.3713187873363495,
            -0.016416676342487335,
            0.2646631598472595,
            -0.2130977362394333,
            -0.3929668664932251,
            -0.23643915355205536,
            -0.4326971769332886,
            -0.2811181843280792,
            0.03175336495041847],
        [   -0.08782752603292465,
            0.5314152240753174,
            -0.341554194688797,
            -0.19832642376422882,
            -0.2556084394454956,
            0.34698963165283203,
            0.44562873244285583,
            0.2920687794685364,
            0.43315282464027405,
            0.4504788815975189,
            -0.1932060271501541,
            -0.21563665568828583,
            0.0973314568400383,
            -0.17575779557228088,
            -0.2417900264263153,
            -0.36389264464378357,
            0.2021554410457611,
            -0.2248716503381729,
            0.25932976603507996,
            -0.2303815633058548,
            -0.20881029963493347,
            0.2078721970319748,
            0.24786847829818726,
            0.008554507978260517,
            -0.19654476642608643,
            -0.04843238741159439,
            -0.1556725651025772,
            0.2717600464820862,
            0.3386356830596924,
            0.25337687134742737,
            0.29344162344932556,
            0.02973688393831253],
        [   -1.0242334604263306,
            -0.4620136022567749,
            -0.6518703699111938,
            -0.4997669756412506,
            0.01566503942012787,
            -0.41673722863197327,
            -0.36689457297325134,
            -0.432753324508667,
            -0.5652667284011841,
            0.09584761410951614,
            -0.23672007024288177,
            -0.06776557862758636,
            -0.8182087540626526,
            -0.20069606602191925,
            -0.31579121947288513,
            -0.2976231575012207,
            -0.6691220998764038,
            -0.0842171311378479,
            -0.44515788555145264,
            -0.640366792678833,
            -0.3656456470489502,
            -0.46430081129074097,
            -0.4586724638938904,
            -0.3476882874965668,
            0.12962284684181213,
            0.012888677418231964,
            -0.17512229084968567,
            -0.9430782198905945,
            -0.20591296255588531,
            0.19622108340263367,
            -0.769408106803894,
            0.35796451568603516],
        [   0.19306854903697968,
            -0.019572939723730087,
            0.4109237790107727,
            -0.35260793566703796,
            -0.11098124086856842,
            -0.11540650576353073,
            -0.42835500836372375,
            0.42237532138824463,
            -0.10650795698165894,
            -0.2754703462123871,
            -0.10298086702823639,
            0.4050337076187134,
            -0.14729580283164978,
            0.4505881369113922,
            0.5479464530944824,
            0.16189101338386536,
            0.20217546820640564,
            0.22038540244102478,
            0.08100444823503494,
            -0.019035937264561653,
            0.22897443175315857,
            -0.029304245486855507,
            -0.13782085478305817,
            0.043247442692518234,
            -0.013990365900099277,
            -0.00017385525279678404,
            -0.13990715146064758,
            0.09275493770837784,
            0.25900378823280334,
            -0.12426669895648956,
            0.12231181561946869,
            0.31504249572753906],
        [   -0.012966725043952465,
            -0.0762685239315033,
            -0.3694404065608978,
            -0.019170528277754784,
            -0.07601524144411087,
            -0.5117426514625549,
            -0.5521601438522339,
            -0.16314509510993958,
            -0.24812103807926178,
            0.0458177886903286,
            -0.0876212865114212,
            0.07879280298948288,
            -0.5612339377403259,
            -0.2628968060016632,
            0.06435103714466095,
            -0.0444910041987896,
            -0.47047674655914307,
            -0.5485666990280151,
            -0.561897873878479,
            0.1337805539369583,
            -0.22037509083747864,
            -0.14042241871356964,
            -0.13520091772079468,
            -0.10205138474702835,
            -0.09870699793100357,
            -0.08303222060203552,
            -0.11320057511329651,
            0.10314025729894638,
            -0.11208152025938034,
            -0.046090494841337204,
            -0.6682554483413696,
            0.1387195736169815],
        [   -1.238014817237854,
            0.03140043094754219,
            -1.321724534034729,
            0.024832364171743393,
            0.0827416181564331,
            -0.5754567384719849,
            0.19854694604873657,
            0.14507798850536346,
            -1.2684779167175293,
            -0.016886606812477112,
            0.08201897889375687,
            0.06542861461639404,
            -1.6552790403366089,
            0.06896115094423294,
            -1.0495173931121826,
            -1.0224158763885498,
            -1.1117194890975952,
            -0.056760646402835846,
            0.07003079354763031,
            -1.357669711112976,
            -0.6022791266441345,
            0.10235514491796494,
            -1.6116844415664673,
            0.10831371694803238,
            -0.10273174941539764,
            -0.15356497466564178,
            -0.06481357663869858,
            -0.7230193018913269,
            -0.7520570755004883,
            0.16304783523082733,
            -1.108891248703003,
            0.22586992383003235],
        [   -0.03336816281080246,
            0.20828022062778473,
            0.46803900599479675,
            -0.2177482396364212,
            0.37041953206062317,
            0.24859392642974854,
            -0.06357185542583466,
            0.46082594990730286,
            0.2510851323604584,
            0.42771831154823303,
            -0.26295679807662964,
            0.05266237258911133,
            -0.22352148592472076,
            -0.19140847027301788,
            -0.2921741008758545,
            0.4152831435203552,
            -0.14678868651390076,
            -0.12527117133140564,
            -0.2959632873535156,
            0.4934339225292206,
            -0.22587253153324127,
            0.7703984379768372,
            -0.01784968376159668,
            0.004148887470364571,
            0.24933911859989166,
            -0.007658823858946562,
            -0.26147228479385376,
            0.05563301220536232,
            -0.005296019371598959,
            0.44517087936401367,
            0.3196559250354767,
            -0.046828657388687134],
        [   0.2762730121612549,
            -0.17659157514572144,
            -0.06274057924747467,
            -0.3015032708644867,
            0.05811642110347748,
            0.11745348572731018,
            0.35812142491340637,
            -0.2710137963294983,
            0.07878084480762482,
            -0.21940602362155914,
            0.48967158794403076,
            -0.6669872999191284,
            0.18285509943962097,
            -0.14913468062877655,
            0.23993679881095886,
            0.08357135206460953,
            0.14473839104175568,
            0.1471257507801056,
            0.17674340307712555,
            0.10570382326841354,
            0.16095028817653656,
            -0.17098310589790344,
            0.13684462010860443,
            0.16085973381996155,
            -0.007801821921020746,
            -0.8058980703353882,
            -0.3532158136367798,
            0.20061588287353516,
            0.029984889551997185,
            0.44842877984046936,
            0.2526463270187378,
            -0.5520045757293701],
        [   0.37251487374305725,
            0.3219018280506134,
            -0.3146911561489105,
            -0.22832736372947693,
            -0.06918860971927643,
            -0.17725129425525665,
            -0.04364818334579468,
            -0.15883071720600128,
            -0.44434136152267456,
            -0.4649201035499573,
            -0.3889092803001404,
            0.02606290765106678,
            0.29571765661239624,
            0.22823649644851685,
            -0.06912065297365189,
            0.5040534734725952,
            0.6532776951789856,
            -0.030658386647701263,
            -0.08915740251541138,
            -0.39886268973350525,
            -0.040639728307724,
            0.4949553906917572,
            0.47552257776260376,
            0.062260787934064865,
            0.1368263214826584,
            0.017366798594594002,
            -0.28388896584510803,
            0.5206091403961182,
            -0.18315693736076355,
            -0.2568642795085907,
            -0.2478152960538864,
            -0.19681136310100555],
        [   -0.3798738718032837,
            -0.36754748225212097,
            0.21810197830200195,
            -0.11448206752538681,
            0.7838547825813293,
            0.4142701327800751,
            -0.030140500515699387,
            0.7171818017959595,
            -0.33038049936294556,
            0.23804616928100586,
            0.07145468890666962,
            -0.32118499279022217,
            0.3850729167461395,
            -0.3789113163948059,
            0.26009517908096313,
            -0.42823687195777893,
            -0.24443978071212769,
            -0.3330231010913849,
            -0.1763003170490265,
            -0.02732044644653797,
            -0.37643471360206604,
            0.581204354763031,
            -0.057407453656196594,
            -0.292070597410202,
            -0.24090731143951416,
            0.14570163190364838,
            0.01641022227704525,
            0.5094881653785706,
            -0.5766303539276123,
            0.261017769575119,
            -0.2870921492576599,
            -0.4763614237308502],
        [   0.21356628835201263,
            -0.27283549308776855,
            0.18102633953094482,
            -0.12686163187026978,
            0.6829961538314819,
            -0.10970226675271988,
            0.6395289301872253,
            -0.30590689182281494,
            0.06539721041917801,
            -0.0852229967713356,
            0.09715588390827179,
            0.40711483359336853,
            0.37361612915992737,
            0.49192002415657043,
            -0.6986184120178223,
            0.5701817274093628,
            -0.6724379062652588,
            -0.759087324142456,
            -0.7046335935592651,
            -0.6221302151679993,
            0.1370542198419571,
            0.5914314985275269,
            -0.08393219858407974,
            -0.15036986768245697,
            -0.3123382031917572,
            -0.7565164566040039,
            -0.11332689225673676,
            0.013238254003226757,
            -0.1229993999004364,
            -0.08542446047067642,
            0.3524262011051178,
            -0.48135140538215637],
        [   -0.2489754855632782,
            -0.047120578587055206,
            -0.10204561799764633,
            -0.04555825889110565,
            0.27128899097442627,
            0.12591759860515594,
            -0.10319595783948898,
            -0.47244200110435486,
            -0.3791465759277344,
            -0.3842298090457916,
            0.08567330241203308,
            -0.16801269352436066,
            -0.5007677674293518,
            0.13763846457004547,
            -0.2915431559085846,
            -0.26982590556144714,
            -0.5043683648109436,
            -0.09981726855039597,
            -0.4039272665977478,
            -0.34202829003334045,
            -0.2955048978328705,
            -0.5398820638656616,
            -0.30439293384552,
            0.09195597469806671,
            0.19471409916877747,
            -0.19313013553619385,
            0.09175132215023041,
            0.06702078133821487,
            -0.1601244956254959,
            -0.5285578966140747,
            -0.3855244815349579,
            0.27192163467407227],
        [   0.26013752818107605,
            -0.5251978039741516,
            -0.008066036738455296,
            0.043211013078689575,
            -0.1356513798236847,
            0.23253098130226135,
            0.12851282954216003,
            -0.27110597491264343,
            0.08457180857658386,
            -0.06492974609136581,
            -0.4920739233493805,
            -0.3818533718585968,
            -0.4376833140850067,
            -0.19673244655132294,
            -0.562300980091095,
            0.26525458693504333,
            -0.5518082976341248,
            0.030338790267705917,
            -0.45858466625213623,
            0.09362456202507019,
            0.2514842450618744,
            -0.08996062725782394,
            -0.3443942368030548,
            0.25690382719039917,
            0.09769205749034882,
            0.23516131937503815,
            0.13914498686790466,
            0.16985197365283966,
            -0.7035810947418213,
            -0.35961779952049255,
            -0.0687432736158371,
            0.20397314429283142]],
    [   0.4084405303001404,
        0.34044310450553894,
        0.2043534815311432,
        -0.08150362223386765,
        -0.015079246833920479,
        0.17966310679912567,
        0.3082873523235321,
        0.17369797825813293,
        0.21412673592567444,
        0.2987278401851654,
        0.18620626628398895,
        0.13169081509113312,
        0.33720162510871887,
        0.12145040184259415,
        0.4549908936023712,
        0.27324217557907104,
        0.3325284421443939,
        0.22580794990062714,
        0.2330438494682312,
        0.3096635043621063,
        0.19124996662139893,
        0.20383240282535553,
        0.17839469015598297,
        0.20056888461112976,
        -0.025740990415215492,
        -0.0650225579738617,
        -0.06870820373296738,
        0.23188385367393494,
        0.3586343824863434,
        0.35067495703697205,
        0.33443471789360046,
        -0.09311224520206451],
    [   [   -0.23718248307704926,
            0.16785237193107605,
            -0.304756760597229,
            0.4909512400627136,
            0.38739797472953796,
            0.650785505771637,
            0.3375350832939148,
            0.20481494069099426,
            -0.1442541480064392,
            -0.2413826286792755,
            -0.0019526160322129726,
            1.0217574834823608,
            -0.2639961838722229,
            0.026755142956972122,
            0.7292105555534363,
            0.08407482504844666],
        [   -0.39007458090782166,
            0.42082899808883667,
            -0.16430224478244781,
            0.7014685273170471,
            0.49586135149002075,
            0.7821872234344482,
            0.5372502207756042,
            0.31806865334510803,
            -0.14185206592082977,
            -0.018368782475590706,
            -0.14414054155349731,
            1.250411033630371,
            -0.6881648898124695,
            -0.24744677543640137,
            1.2503610849380493,
            0.07892367243766785],
        [   -0.38452965021133423,
            0.15461431443691254,
            -0.14877404272556305,
            0.7279880046844482,
            0.5594112277030945,
            0.5998289585113525,
            -0.15122400224208832,
            0.5055062770843506,
            -0.20087788999080658,
            -0.0386802963912487,
            0.09787567704916,
            0.7224872708320618,
            0.09968564659357071,
            -0.45184722542762756,
            0.9468103647232056,
            -0.19720952212810516],
        [   -0.5286014080047607,
            -0.11619225889444351,
            -0.06454282999038696,
            -0.32438817620277405,
            0.11921702325344086,
            0.35259944200515747,
            -0.5677620768547058,
            -0.2657341957092285,
            -0.009670752100646496,
            -0.5883187651634216,
            -0.16781486570835114,
            -0.19011391699314117,
            0.02708900347352028,
            0.14614999294281006,
            -0.4935344159603119,
            -0.10444395244121552],
        [   0.04397181048989296,
            0.13837455213069916,
            -0.09644119441509247,
            0.7374699711799622,
            0.2688666582107544,
            0.2814888060092926,
            0.017771383747458458,
            0.006029619835317135,
            -0.31388649344444275,
            0.1953628808259964,
            -0.4595310091972351,
            0.6856991648674011,
            -0.12417828291654587,
            -0.02809862047433853,
            0.4594383239746094,
            0.05014313384890556],
        [   -0.2757149934768677,
            0.47904491424560547,
            -0.027009394019842148,
            0.4822692275047302,
            0.2462235391139984,
            0.34586161375045776,
            -0.42324405908584595,
            0.16238875687122345,
            -0.31541112065315247,
            0.28802961111068726,
            0.12656787037849426,
            0.6979156732559204,
            -0.25957709550857544,
            -0.25091394782066345,
            1.1207839250564575,
            0.06667870283126831],
        [   -0.20157356560230255,
            0.12779511511325836,
            0.20660780370235443,
            0.0021600821055471897,
            0.5598177313804626,
            -0.001049343147315085,
            -0.32231757044792175,
            0.38249731063842773,
            -0.08892051130533218,
            -0.2771625518798828,
            0.16042812168598175,
            0.799923837184906,
            0.03867824003100395,
            -0.16108685731887817,
            0.17702940106391907,
            -0.06235170364379883],
        [   0.0969422236084938,
            0.4615418314933777,
            0.44067829847335815,
            0.6420432925224304,
            0.5379794239997864,
            0.12869557738304138,
            0.31541571021080017,
            0.30598920583724976,
            0.13867567479610443,
            -0.3799874484539032,
            0.23039430379867554,
            0.31325414776802063,
            -0.3172481060028076,
            -0.22414211928844452,
            0.7112261056900024,
            -0.1803765743970871],
        [   -0.11198446899652481,
            0.46596649289131165,
            -0.1843218058347702,
            0.42645180225372314,
            0.4611981213092804,
            0.030127117410302162,
            0.26360592246055603,
            0.12051914632320404,
            0.16238318383693695,
            0.30071794986724854,
            0.035394296050071716,
            0.19462226331233978,
            -0.47494781017303467,
            -0.27798131108283997,
            0.058040816336870193,
            -0.19203771650791168],
        [   0.03498034179210663,
            0.09281030297279358,
            0.4590754210948944,
            0.29905253648757935,
            0.08474408090114594,
            0.3088177442550659,
            -0.36602145433425903,
            0.19357742369174957,
            -0.1537652611732483,
            -0.39327630400657654,
            0.35615187883377075,
            0.21779516339302063,
            0.2621939182281494,
            0.26498815417289734,
            -0.07729164510965347,
            0.39071181416511536],
        [   -0.31111881136894226,
            0.3275744616985321,
            -0.32403337955474854,
            0.19280865788459778,
            0.14761166274547577,
            0.3332315981388092,
            -0.31354328989982605,
            -0.2733214497566223,
            -0.24915063381195068,
            -0.4252496361732483,
            -0.4257282614707947,
            -0.08863665163516998,
            0.4444187581539154,
            0.32628583908081055,
            0.2663343548774719,
            -0.07809324562549591],
        [   -0.1210109293460846,
            0.5689358711242676,
            -0.18257197737693787,
            0.06680195778608322,
            -0.3607238531112671,
            0.36987560987472534,
            0.16410240530967712,
            0.31954672932624817,
            -0.14100021123886108,
            -1.2020235061645508,
            -0.3835488259792328,
            0.6513330340385437,
            -0.396655410528183,
            -0.2629345953464508,
            0.44354236125946045,
            0.1488332897424698],
        [   -0.13405650854110718,
            0.416024774312973,
            -0.3784259557723999,
            0.776567816734314,
            0.27121424674987793,
            0.537743091583252,
            -0.23047517240047455,
            0.41872045397758484,
            -0.26093795895576477,
            0.08274123817682266,
            0.187360942363739,
            0.7064369320869446,
            -0.3958064913749695,
            -0.16629794239997864,
            1.2411311864852905,
            -0.057287003844976425],
        [   0.21149273216724396,
            0.25177180767059326,
            -0.19010096788406372,
            0.37790340185165405,
            0.17545945942401886,
            0.04680792987346649,
            -0.3666764497756958,
            -0.31321680545806885,
            -0.2778099477291107,
            -0.21821963787078857,
            -0.6453725099563599,
            0.0029437788762152195,
            0.31212711334228516,
            -0.21848078072071075,
            -0.06824933737516403,
            -0.6402149200439453],
        [   -0.3618054687976837,
            0.12725764513015747,
            -0.05706692114472389,
            0.5497453808784485,
            0.5755950808525085,
            0.7044737935066223,
            -0.28558415174484253,
            0.11454249173402786,
            0.03936752676963806,
            0.04094170033931732,
            0.059086285531520844,
            1.2233961820602417,
            -0.296072781085968,
            -0.35882240533828735,
            1.5073094367980957,
            0.08167130500078201],
        [   -0.30302491784095764,
            0.5397787094116211,
            -0.09332017600536346,
            0.7119907736778259,
            0.5570663213729858,
            0.08249169588088989,
            0.028958728536963463,
            0.4550310969352722,
            -0.06246114894747734,
            0.058880507946014404,
            -0.0990741029381752,
            0.6649815440177917,
            -0.1263754516839981,
            0.01162963267415762,
            1.1686140298843384,
            0.18025854229927063],
        [   -0.03389667347073555,
            0.32749807834625244,
            -0.31384506821632385,
            0.5322476029396057,
            0.4175722599029541,
            0.20285004377365112,
            0.1051650270819664,
            0.3822357952594757,
            0.09016569703817368,
            -0.11954877525568008,
            -0.3536849319934845,
            0.44032004475593567,
            0.09652779251337051,
            -0.02561751939356327,
            1.0667734146118164,
            0.13338671624660492],
        [   0.31039509177207947,
            0.1601613461971283,
            -0.027867864817380905,
            0.07257715612649918,
            0.3361124098300934,
            0.11664766818284988,
            -0.4048518240451813,
            0.4944210350513458,
            -0.13555552065372467,
            -0.0555301196873188,
            -0.4435116648674011,
            0.34778961539268494,
            0.03306389972567558,
            -0.0026137237437069416,
            0.021639911457896233,
            -0.6350111365318298],
        [   -0.05959387123584747,
            0.2468303143978119,
            0.04363568127155304,
            0.252588152885437,
            0.18628022074699402,
            0.09451652318239212,
            -0.40808144211769104,
            -0.10664794594049454,
            -0.08788974583148956,
            0.2576235830783844,
            0.22925449907779694,
            0.6542471647262573,
            0.3422923982143402,
            0.054149553179740906,
            -0.3134733736515045,
            0.11388371139764786],
        [   -0.17349344491958618,
            -0.0038074678741395473,
            -0.40396103262901306,
            0.6745431423187256,
            0.49975618720054626,
            0.38542547821998596,
            -0.06964825838804245,
            0.3218288719654083,
            -0.12499265372753143,
            0.19094876945018768,
            0.1849425584077835,
            0.8788875937461853,
            -0.12019559741020203,
            -0.10330890864133835,
            1.2987124919891357,
            0.10841309279203415],
        [   -0.024614481255412102,
            0.1640666425228119,
            -0.08925989270210266,
            0.3367495834827423,
            0.3211613893508911,
            0.27899840474128723,
            0.12483294308185577,
            0.39797908067703247,
            -0.30613863468170166,
            0.28476792573928833,
            0.06713998317718506,
            0.4446575939655304,
            -0.0209895558655262,
            -0.3652607202529907,
            0.755753219127655,
            -0.39048415422439575],
        [   -0.271025687456131,
            0.4050839841365814,
            -0.02647469751536846,
            1.0413655042648315,
            0.5917920470237732,
            -0.0012711158487945795,
            -0.17133501172065735,
            0.08900900185108185,
            0.07247491925954819,
            0.03394217789173126,
            -0.16384920477867126,
            0.5892654061317444,
            0.04933449998497963,
            -0.09433397650718689,
            -0.04334564879536629,
            0.1615424007177353],
        [   -0.33932986855506897,
            0.24360555410385132,
            -0.18777316808700562,
            0.4326499104499817,
            0.5107230544090271,
            0.03148240968585014,
            0.1786910742521286,
            0.5766937136650085,
            -0.10688984394073486,
            -0.30342617630958557,
            0.07960198819637299,
            0.19863909482955933,
            -0.4229433536529541,
            -0.39744967222213745,
            0.8294272422790527,
            -0.031033800914883614],
        [   0.03543814644217491,
            0.04281545430421829,
            0.35009798407554626,
            0.36707040667533875,
            0.16516345739364624,
            0.050131574273109436,
            -0.19933567941188812,
            0.2636233866214752,
            -0.2599392533302307,
            -0.08377420902252197,
            -0.082735076546669,
            0.14076100289821625,
            -0.19840781390666962,
            -0.4263092875480652,
            0.447389155626297,
            0.20038115978240967],
        [   0.16339243948459625,
            -0.18463774025440216,
            0.2661585509777069,
            -0.21274413168430328,
            0.06906171143054962,
            0.013659020885825157,
            0.12636490166187286,
            -0.1980791985988617,
            0.3860239088535309,
            -0.22930654883384705,
            -0.11357316374778748,
            0.22573097050189972,
            -0.20819228887557983,
            0.05534444749355316,
            0.861596941947937,
            0.4158651828765869],
        [   0.33674755692481995,
            0.7632109522819519,
            -1.3552409410476685,
            0.00943654403090477,
            -0.41844746470451355,
            0.15293973684310913,
            1.224554181098938,
            0.2669484317302704,
            -0.909268856048584,
            -0.7422584295272827,
            -1.489079475402832,
            0.615859866142273,
            0.28352805972099304,
            0.3245781362056732,
            0.8121719360351562,
            -1.4616005420684814],
        [   -0.48130741715431213,
            -0.17503198981285095,
            -0.2833265960216522,
            -0.177076518535614,
            -0.01108664833009243,
            -0.11571600288152695,
            -0.31071797013282776,
            0.3052577078342438,
            0.09962498396635056,
            -0.4387589991092682,
            -0.003367468947544694,
            -0.11665064841508865,
            0.2159789800643921,
            0.1828005611896515,
            -0.6499127745628357,
            -0.09929464757442474],
        [   0.08004573732614517,
            0.3505052328109741,
            -0.26595667004585266,
            0.2660556137561798,
            0.13649733364582062,
            0.1791573464870453,
            -0.13267245888710022,
            0.4028371274471283,
            0.027407530695199966,
            -0.09881128370761871,
            -0.27777528762817383,
            0.5292800664901733,
            -0.27902036905288696,
            0.1526542454957962,
            0.3809944689273834,
            -0.2695576548576355],
        [   0.11644887179136276,
            -0.00546089094132185,
            0.17492961883544922,
            0.5274697542190552,
            0.14777377247810364,
            0.13669006526470184,
            0.2573401629924774,
            0.5447390079498291,
            -0.046260587871074677,
            -0.15963418781757355,
            -0.251864492893219,
            0.47026902437210083,
            -0.3067343533039093,
            -0.45183542370796204,
            1.0774316787719727,
            -0.09856101870536804],
        [   0.3451632261276245,
            -0.19065529108047485,
            0.008089200593531132,
            0.41540518403053284,
            0.2542977035045624,
            0.08975301682949066,
            -0.5144781470298767,
            0.6136643886566162,
            0.23070427775382996,
            0.11457643657922745,
            0.22253575921058655,
            0.05544843152165413,
            -0.21603275835514069,
            -0.10404560714960098,
            -0.05549272522330284,
            0.06731035560369492],
        [   0.2151378095149994,
            0.24188612401485443,
            -0.3538082242012024,
            0.39590996503829956,
            0.5917920470237732,
            0.4248676598072052,
            0.3202584385871887,
            0.08822387456893921,
            0.12679286301136017,
            -0.17961066961288452,
            -0.1824415773153305,
            0.460098534822464,
            -0.4455965459346771,
            -0.12640458345413208,
            1.7207380533218384,
            -0.278651624917984],
        [   -0.21186743676662445,
            0.1435561329126358,
            0.2903921902179718,
            -0.4091128706932068,
            -0.15283289551734924,
            -0.012654523365199566,
            0.2930421829223633,
            -0.24226723611354828,
            0.12655892968177795,
            0.3268603980541229,
            0.31399643421173096,
            0.38266846537590027,
            -0.4507676959037781,
            -0.5623093843460083,
            0.05337383970618248,
            0.2183772772550583]],
    [   0.050148241221904755,
        0.033401139080524445,
        0.2493351548910141,
        0.0888194590806961,
        0.06334104388952255,
        0.08001753687858582,
        -0.2545679211616516,
        0.15428578853607178,
        0.18434372544288635,
        0.24024559557437897,
        0.22876979410648346,
        0.24321205914020538,
        -0.049247849732637405,
        -0.08722758293151855,
        -0.05220339447259903,
        0.1834397315979004],
    [   [0.3785032033920288],
        [-0.5887410640716553],
        [0.4332023561000824],
        [-0.8862563967704773],
        [-0.34110182523727417],
        [-0.492943674325943],
        [-0.4854992926120758],
        [-0.39937928318977356],
        [0.27055269479751587],
        [1.7781765460968018],
        [0.3147890269756317],
        [-0.5903089642524719],
        [0.22142928838729858],
        [0.6120278239250183],
        [-0.8286423087120056],
        [0.32348066568374634]],
    [-0.028481237590312958]]



### train.py


import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import pandas as pd
import tensorflow as tf
from sklearn.metrics import classification_report

df.drop(columns=['pr','src_ip', 'dst_ip', 'src_pt', 'dst_pt', 'cnt','bts', 'flgs'], inplace=True)

df = pd.get_dummies(df, columns=['dst_subnet'], drop_first=True)

# Separate features and target

X = df


# Preprocess the features
scaler = StandardScaler()
X = scaler.fit_transform(X)


# Define the model
model = Sequential()
model.add(Dense(32, input_dim=X.shape[1], activation='relu'))  # Input layer
model.add(Dense(16, activation='relu'))  # Hidden layer
model.add(Dense(1, activation='sigmoid'))  # Output layer

weights = [np.array(w) for w in weights]
model.set_weights(weights)


# Make predictions on the new DataFrame
y_pred_new = model.predict(X)
y_pred_new = (y_pred_new > 0.5)

# Print the predictions
# print(y_pred_new)
# Convert the predictions to a pandas Series
y_pred_new_series = pd.Series(y_pred_new.flatten())

# Print the value counts
for i in y_pred_new:
    if i == True:
        print('TRUE', flush=True)
    else:
        print('FALSE', flush=True)

