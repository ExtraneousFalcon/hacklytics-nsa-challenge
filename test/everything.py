### pre_process.py
import pandas as pd
import datetime
import socket
import struct

# Function to convert hex timestamp to datetime
def hex_to_datetime(hex_ts):
    return datetime.datetime.utcfromtimestamp(int(hex_ts, 16))

# Function to convert hex IP to string IP
def hex_to_ip(hex_ip):
    return socket.inet_ntoa(struct.pack('!L', int(hex_ip, 16)))

# Function to convert hex to int
def hex_to_int(hex_val):
    return int(hex_val, 16)

# Function to parse a row
def parse_row(row):
    parts = row.split()
    return {
        'ts': hex_to_datetime(parts[0][:-1]),
        'pr': 'tcp',
        'src_ip': hex_to_ip(parts[2].split('.')[0]),
        'src_pt': hex_to_int(parts[2].split('.')[1]),
        'dst_ip': hex_to_ip(parts[3].split('.')[0]),
        'dst_pt': hex_to_int(parts[3].split('.')[1]),
        'cnt': hex_to_int(parts[4]),
        'bts': hex_to_int(parts[5]),
        'flgs': parts[6]
    }

# Read the file
with open('netflow_format.txt', 'r') as f:
    data = [parse_row(row) for row in f]

# Convert the data to a DataFrame
df = pd.DataFrame(data)

### add_dst_subnet.py

import pandas as pd
import ipaddress

# Define the subnets
subnets = [ipaddress.ip_network('128.61.0.0/16'), ipaddress.ip_network('130.207.0.0/16'), 
           ipaddress.ip_network('143.215.0.0/16'), ipaddress.ip_network('192.76.181.0/24')]

# Function to assign each IP to a subnet
def assign_subnet(ip):
    for subnet in subnets:
        if ipaddress.ip_address(ip) in subnet:
            return str(subnet)
    return 'other'

# Assign each destination IP to a subnet
df['dst_subnet'] = df['dst_ip'].apply(assign_subnet)


### features.py

import pandas as pd
import numpy as np

# Convert the timestamp to a datetime object
df['ts'] = pd.to_datetime(df['ts'])

# Ensure 'ts' is the DataFrame's index
df.set_index('ts', inplace=True)

# Add small random noise to 'ts' column to ensure all timestamps are unique
df.index += pd.to_timedelta(np.random.randint(0, 1000), unit='ms')

# Calculate the number of connections an IP makes per minute in a separate DataFrame
num_connections_per_minute = df.groupby('src_ip').resample('1T')['dst_ip'].count().reset_index()
num_connections_per_minute.columns = ['src_ip', 'ts', 'num_connections_per_minute']

# Merge the new DataFrame with the original DataFrame
df = pd.merge(df.reset_index(), num_connections_per_minute, on=['src_ip', 'ts'], how='left')

# Fill NaN values with 0
df['num_connections_per_minute'].fillna(0, inplace=True)

# Ensure 'ts' is the DataFrame's index again
df.set_index('ts', inplace=True)

# Continue with the rest of your code...

# Calculate the number of unique servers an IP connects to
df['num_unique_servers'] = df.groupby('src_ip')['dst_ip'].transform('nunique')

# Calculate the total bytes transferred by an IP
df['total_bytes_transferred'] = df.groupby('src_ip')['bts'].transform('sum')

# Calculate the average number of packets exchanged per session for each pair of source and destination IPs
df['avg_packets_per_session'] = df.groupby(['src_ip', 'dst_ip'])['cnt'].transform('mean')

# Reset the index
df.reset_index(inplace=True)

# Calculate the number of SYN flags sent by an IP
df['num_syn_flags'] = df[df['flgs'].str.contains('S')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of ACK flags sent by an IP
df['num_ack_flags'] = df[df['flgs'].str.contains('A')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of RST flags sent by an IP
df['num_rst_flags'] = df[df['flgs'].str.contains('R')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of FIN flags sent by an IP
df['num_fin_flags'] = df[df['flgs'].str.contains('F')].groupby('src_ip')['flgs'].transform('count')

# Calculate the number of connections an IP makes to the same server
df['num_connections_to_same_server'] = df.groupby(['src_ip', 'dst_ip']).transform('size')

# Calculate the number of connections an IP makes to different subnets
df['num_connections_to_diff_subnets'] = df.groupby('src_ip')['dst_subnet'].transform('nunique')

# Calculate the number of connections an IP makes after network admins have gone home for the day
df['num_connections_after_hours'] = df[df['ts'].dt.hour.isin(range(18, 24))].groupby('src_ip')['dst_ip'].transform('count')

# Fill NaN values with 0
df.fillna(0, inplace=True)

# Set 'ts' as the index again
df.set_index('ts', inplace=True)

weights =[   [   [   0.2323787808418274,
            -0.10677400231361389,
            0.29892778396606445,
            0.21767568588256836,
            -0.01004287600517273,
            0.28072142601013184,
            0.21732598543167114,
            -0.26298636198043823,
            0.16750675439834595,
            0.2913095951080322,
            0.29614347219467163,
            -0.34920769929885864,
            0.04329922795295715,
            -0.3475617468357086,
            -0.2255069613456726,
            -0.325642853975296,
            -0.28153276443481445,
            -0.29141759872436523,
            -0.0681363046169281,
            0.3527827858924866,
            0.22100704908370972,
            -0.1774916797876358,
            0.17191004753112793,
            0.13928309082984924,
            -0.12613636255264282,
            -0.00784313678741455,
            0.2854820489883423,
            -0.2013297975063324,
            -0.0807759165763855,
            -0.21561791002750397,
            -0.13550014793872833,
            -0.19849984347820282],
        [   -0.2849959433078766,
            -0.9297488927841187,
            -0.1519138067960739,
            0.3564153015613556,
            0.26821985840797424,
            -0.7768919467926025,
            0.17487365007400513,
            -0.5799989700317383,
            -0.12665367126464844,
            0.34661343693733215,
            -0.6025630831718445,
            -0.0804792046546936,
            -1.101351261138916,
            0.2557615041732788,
            0.6754686236381531,
            -1.6629219055175781,
            -1.324805736541748,
            -0.5622126460075378,
            0.09026185423135757,
            -0.9199764728546143,
            0.34508153796195984,
            -0.07284200191497803,
            -0.14527499675750732,
            -0.10674482583999634,
            -0.9469857811927795,
            0.801016628742218,
            -0.5368242263793945,
            0.30116429924964905,
            0.1633908748626709,
            -0.5766875147819519,
            -0.6100255846977234,
            -0.5579743385314941],
        [   -0.0571722649037838,
            -0.18993379175662994,
            0.398396372795105,
            0.2916777729988098,
            0.6982248425483704,
            0.00111577904317528,
            0.27337223291397095,
            -0.3064141571521759,
            -0.003017210867255926,
            0.6288732290267944,
            0.17926883697509766,
            -0.2046203911304474,
            0.07408446073532104,
            0.48541688919067383,
            -0.09128379821777344,
            0.21687005460262299,
            0.09318062663078308,
            0.17214713990688324,
            -0.0910915806889534,
            0.36496150493621826,
            0.048217058181762695,
            0.11704310029745102,
            -0.03785358741879463,
            -0.3746175765991211,
            0.5304853916168213,
            -0.020685268566012383,
            0.4053592383861542,
            -0.13752427697181702,
            -0.045955486595630646,
            0.12105278670787811,
            -0.21174263954162598,
            0.006220489740371704],
        [   0.24355675280094147,
            -0.6248586177825928,
            -0.5361232161521912,
            0.21489180624485016,
            0.42551884055137634,
            0.2308073788881302,
            0.3470540940761566,
            0.11969653517007828,
            -0.17425119876861572,
            0.11908584833145142,
            -0.0032981226686388254,
            0.7437368035316467,
            0.6136804223060608,
            0.10617540031671524,
            1.0138373374938965,
            0.1126275509595871,
            0.3545825183391571,
            0.6873863339424133,
            0.38631895184516907,
            -0.05843004584312439,
            0.3755843937397003,
            0.8023568987846375,
            0.7026816606521606,
            0.13641898334026337,
            -0.3913531005382538,
            0.026909247040748596,
            -0.4594038724899292,
            -0.01929587312042713,
            0.7603927850723267,
            -0.2003442496061325,
            0.6427469253540039,
            -0.07844619452953339],
        [   -0.15872682631015778,
            -2.053008794784546,
            -1.144075632095337,
            0.2529774308204651,
            0.20918148756027222,
            -1.519950032234192,
            0.38443315029144287,
            -0.43773823976516724,
            -0.7201861143112183,
            0.07523892819881439,
            0.03748228773474693,
            0.02041005901992321,
            -1.8744865655899048,
            0.19248969852924347,
            -0.34439966082572937,
            -2.778658151626587,
            -0.22719253599643707,
            -1.4052538871765137,
            -0.08949367702007294,
            -1.9818087816238403,
            0.5164640545845032,
            -0.22144649922847748,
            -0.9951788783073425,
            -0.9862092137336731,
            -2.403351068496704,
            -0.48976191878318787,
            -1.6750091314315796,
            0.041681282222270966,
            -0.8521078824996948,
            -0.10434756428003311,
            -1.5354636907577515,
            -1.0166443586349487],
        [   -0.1685900241136551,
            0.5766773819923401,
            0.2829570770263672,
            0.22838307917118073,
            0.6416345238685608,
            0.19347405433654785,
            0.1576368510723114,
            -0.17778818309307098,
            0.23136642575263977,
            0.6840909719467163,
            0.7475232481956482,
            0.002023696433752775,
            0.1929064691066742,
            -0.07758328318595886,
            0.01786150224506855,
            0.19065360724925995,
            0.27289626002311707,
            0.19200217723846436,
            0.5451442003250122,
            0.30368921160697937,
            0.4875656068325043,
            -0.05723601207137108,
            -0.046328939497470856,
            0.09396804869174957,
            0.611193835735321,
            0.207556813955307,
            0.4566904306411743,
            0.05563367158174515,
            -0.2585820257663727,
            -0.35032516717910767,
            -0.3595840036869049,
            0.0053043607622385025],
        [   0.06375262886285782,
            -0.4534740746021271,
            -0.22546309232711792,
            0.04372512921690941,
            -0.19677592813968658,
            -0.6768743395805359,
            -0.14877204596996307,
            1.0023339986801147,
            0.028393438085913658,
            0.29284346103668213,
            -0.414645791053772,
            -0.016246700659394264,
            -0.6015393733978271,
            -0.12134747207164764,
            -0.4780048429965973,
            -0.2771588861942291,
            -0.7360609173774719,
            -0.23057426512241364,
            0.12524719536304474,
            -0.08395492285490036,
            0.04178108274936676,
            0.26257964968681335,
            -0.4515979290008545,
            -0.7459129095077515,
            -0.42157700657844543,
            -0.286410927772522,
            -0.6073874831199646,
            0.24552330374717712,
            -0.1547602415084839,
            0.03732737526297569,
            -0.3842047154903412,
            -0.5828695893287659],
        [   0.021791473031044006,
            -3.2728476524353027,
            -5.105590343475342,
            -0.17707718908786774,
            0.23849545419216156,
            -2.607095718383789,
            0.3566201329231262,
            -0.5195525288581848,
            -1.0698059797286987,
            0.10686838626861572,
            0.11861161142587662,
            -6.208709239959717,
            -0.8787360191345215,
            0.009041848592460155,
            0.5890414714813232,
            -0.06947720050811768,
            0.36128395795822144,
            -0.8015030026435852,
            -2.6619784832000732,
            -0.39267635345458984,
            0.5487713813781738,
            0.5191192030906677,
            -1.9733798503875732,
            -6.441103935241699,
            0.5134704113006592,
            0.38019871711730957,
            0.04169933497905731,
            -0.31845223903656006,
            -7.061799049377441,
            -0.6463092565536499,
            -7.106778621673584,
            -0.5458908081054688],
        [   0.570650041103363,
            0.36434781551361084,
            0.6379086375236511,
            0.2640584111213684,
            7.015089988708496,
            0.3096398413181305,
            4.139955043792725,
            -0.0648583471775055,
            -0.48009490966796875,
            -0.022806314751505852,
            0.7953220009803772,
            0.5018976926803589,
            0.03075520321726799,
            0.7034269571304321,
            -0.31527313590049744,
            0.05245578661561012,
            -0.10404743999242783,
            -0.28784462809562683,
            0.5068362355232239,
            -0.16009661555290222,
            3.7106306552886963,
            -0.334860235452652,
            -0.22939953207969666,
            0.5440327525138855,
            -0.09031238406896591,
            0.3478814661502838,
            0.7642738223075867,
            -0.379564106464386,
            0.6479440331459045,
            -0.3591965436935425,
            0.5366089344024658,
            0.035755764693021774],
        [   0.05550641566514969,
            0.3055584132671356,
            0.20880191028118134,
            1.4496936798095703,
            0.36567381024360657,
            0.09752737730741501,
            0.30814245343208313,
            0.679049551486969,
            -0.7048773765563965,
            0.32169926166534424,
            -0.13814018666744232,
            -0.525428295135498,
            -0.05461479350924492,
            0.7780023813247681,
            -0.42646855115890503,
            0.28482651710510254,
            -0.5074512958526611,
            -0.10096734762191772,
            -0.49351778626441956,
            -0.0832500234246254,
            0.9134684205055237,
            -0.39796075224876404,
            -0.02035970240831375,
            0.10207576304674149,
            0.09326057136058807,
            1.4312219619750977,
            -0.03007752262055874,
            -1.207366943359375,
            -0.015222585760056973,
            0.907164990901947,
            0.22841446101665497,
            0.02491525374352932],
        [   0.21846263110637665,
            0.6886296272277832,
            0.3204681873321533,
            0.07356991618871689,
            -0.13255968689918518,
            0.1960434764623642,
            0.44587722420692444,
            0.1595134437084198,
            -0.07548698782920837,
            0.6744710206985474,
            0.3327680826187134,
            -0.04291003942489624,
            0.1915072202682495,
            -0.010967250913381577,
            0.27479439973831177,
            -0.12023445963859558,
            0.48735836148262024,
            -0.606688916683197,
            -0.47416093945503235,
            0.16147580742835999,
            0.3173198401927948,
            0.19189360737800598,
            0.21060805022716522,
            0.8341525793075562,
            -0.0598679780960083,
            0.5438369512557983,
            0.19883792102336884,
            0.31519103050231934,
            -0.22939333319664001,
            -0.3224882483482361,
            -0.30956998467445374,
            -0.21901193261146545],
        [   0.6593008637428284,
            0.1263953596353531,
            0.5947338342666626,
            0.06446399539709091,
            -0.116287961602211,
            0.08146121352910995,
            -1.0369961261749268,
            -0.26209330558776855,
            0.2689868211746216,
            0.5016317963600159,
            1.5779600143432617,
            -0.5687164068222046,
            -0.22349542379379272,
            0.022026151418685913,
            -0.04902884364128113,
            0.0072753955610096455,
            -0.8756438493728638,
            -0.15091563761234283,
            -0.5959066152572632,
            -0.28648361563682556,
            -1.0856980085372925,
            -0.04370996356010437,
            -0.4694341719150543,
            0.8464009761810303,
            -0.038191117346286774,
            -0.31912413239479065,
            -0.4885484576225281,
            -0.05592755973339081,
            0.16000346839427948,
            0.32432103157043457,
            0.10172151774168015,
            -0.3871059715747833],
        [   -1.1339526176452637,
            0.06389617174863815,
            -0.5901497006416321,
            -0.4800969660282135,
            1.467785120010376,
            -1.0662785768508911,
            -0.9632785320281982,
            -0.33858275413513184,
            0.07027872651815414,
            -2.118800163269043,
            -0.29364877939224243,
            -0.5583949685096741,
            0.3803436756134033,
            -0.024226102977991104,
            0.07394292205572128,
            -0.6357370615005493,
            -0.8508307933807373,
            0.3476583957672119,
            -0.5139274597167969,
            -0.6878288388252258,
            -1.0190660953521729,
            -0.5747630000114441,
            0.3776259124279022,
            0.8834549188613892,
            0.05159689486026764,
            0.7454206347465515,
            0.5632708668708801,
            0.9560336470603943,
            0.4735317528247833,
            0.618373453617096,
            0.16875365376472473,
            0.4609192907810211],
        [   -0.19449838995933533,
            0.11558853089809418,
            0.09390945732593536,
            0.031280819326639175,
            -0.454418808221817,
            -1.06519615650177,
            0.1682298332452774,
            -0.03343884274363518,
            -0.1605597287416458,
            0.4382438361644745,
            0.2882860004901886,
            -0.5027033090591431,
            -0.947719156742096,
            0.29691073298454285,
            0.3129148781299591,
            -0.3764641582965851,
            -0.9261009097099304,
            0.1801726222038269,
            -0.5310351252555847,
            -0.7277548909187317,
            0.05416113883256912,
            -0.2851420044898987,
            0.2386879175901413,
            -0.3620789051055908,
            0.08905312418937683,
            0.40572458505630493,
            -0.7002876996994019,
            0.029868826270103455,
            -0.03472789749503136,
            0.261687695980072,
            -0.9389864802360535,
            -0.6236111521720886],
        [   0.1321634203195572,
            -1.0069302320480347,
            -0.786785364151001,
            0.4866456389427185,
            -0.24901777505874634,
            -0.41086235642433167,
            0.4053255021572113,
            0.05312802642583847,
            -0.03917667642235756,
            0.3115507960319519,
            0.4200393557548523,
            0.06364576518535614,
            -0.6823704242706299,
            0.22819030284881592,
            0.45082736015319824,
            -0.4597712755203247,
            0.24296803772449493,
            -0.7125290632247925,
            -0.4292556047439575,
            -0.525341272354126,
            0.38681262731552124,
            0.2094121128320694,
            -0.45780402421951294,
            -0.1425117701292038,
            -0.9150630235671997,
            -0.16419582068920135,
            -0.6346207857131958,
            -0.1322011947631836,
            -0.6876370906829834,
            -0.09693706035614014,
            -1.0215121507644653,
            0.15965908765792847]],
    [   0.21872691810131073,
        0.741858959197998,
        0.5698193311691284,
        -0.3632483184337616,
        0.1390291154384613,
        0.7652615308761597,
        -0.46053585410118103,
        0.10640911757946014,
        -0.1445387750864029,
        -0.2810985743999481,
        0.13645948469638824,
        0.26637446880340576,
        0.6168947219848633,
        -0.4686616361141205,
        0.19928595423698425,
        0.20859777927398682,
        0.5985989570617676,
        0.5010136961936951,
        0.31069788336753845,
        0.5055311322212219,
        -0.5095712542533875,
        0.11313917487859726,
        0.18912184238433838,
        0.4480237662792206,
        0.784889817237854,
        0.019322816282510757,
        0.5244901776313782,
        0.44916412234306335,
        0.3942832946777344,
        0.028017783537507057,
        0.8036662340164185,
        0.3942839801311493],
    [   [   0.8444796800613403,
            -0.651411235332489,
            -0.24085603654384613,
            0.1495390385389328,
            -3.4334487915039062,
            0.06204947829246521,
            0.09434457123279572,
            0.9115232825279236,
            -0.08504510670900345,
            0.40742799639701843,
            -0.19399015605449677,
            0.8006037473678589,
            -5.27089262008667,
            0.2934412956237793,
            0.4949842393398285,
            0.613925039768219],
        [   -1.9511926174163818,
            -1.518163800239563,
            -0.5264263153076172,
            1.4146000146865845,
            -1.733128309249878,
            2.950674295425415,
            -0.6637863516807556,
            -2.1440205574035645,
            2.153120279312134,
            1.4434987306594849,
            0.07415739446878433,
            -1.6513645648956299,
            0.15654437243938446,
            1.4004071950912476,
            -1.421656847000122,
            -0.282355934381485],
        [   -0.6930392384529114,
            -0.4126707911491394,
            -0.3255033791065216,
            1.326845645904541,
            -0.10044532269239426,
            2.3706183433532715,
            -0.08218636363744736,
            -1.4268605709075928,
            1.6190640926361084,
            1.5638813972473145,
            0.007570483256131411,
            -0.66498863697052,
            -0.26954060792922974,
            1.331607460975647,
            -0.663365364074707,
            -0.9189351797103882],
        [   1.2353647947311401,
            3.3737006187438965,
            0.8914019465446472,
            -0.15063023567199707,
            -0.5376463532447815,
            -1.682344913482666,
            0.155399888753891,
            2.0020174980163574,
            0.7240769863128662,
            -0.7283787131309509,
            -0.11499284952878952,
            -0.3861776888370514,
            0.0017168654594570398,
            0.21275638043880463,
            3.174703598022461,
            -0.3749697506427765],
        [   -1.355583667755127,
            -4.797111988067627,
            -2.708509922027588,
            5.193442344665527,
            -2.8159358501434326,
            5.167181015014648,
            0.0663573145866394,
            -0.10264232009649277,
            0.7203097939491272,
            0.7862604260444641,
            -0.13605087995529175,
            -0.4096614122390747,
            -3.5355587005615234,
            5.5156145095825195,
            -3.5430681705474854,
            -0.16305731236934662],
        [   -2.1107521057128906,
            -1.5582348108291626,
            0.16829608380794525,
            0.3707701861858368,
            -0.33596092462539673,
            1.025482177734375,
            -0.6666391491889954,
            -2.485565662384033,
            1.3895477056503296,
            -0.1333339363336563,
            0.005192065145820379,
            -0.4885931611061096,
            -0.002744831843301654,
            0.05148747190833092,
            -0.9022566080093384,
            0.15282444655895233],
        [   1.0590322017669678,
            0.31804317235946655,
            -0.15003052353858948,
            -0.017423411831259727,
            0.20844347774982452,
            -0.13685446977615356,
            -0.6051181554794312,
            0.47902414202690125,
            0.0818055048584938,
            -2.363725185394287,
            -0.07013505697250366,
            -0.2951917052268982,
            -0.1771630048751831,
            -0.4219633638858795,
            -0.16538704931735992,
            -0.5187934637069702],
        [   0.6049612760543823,
            1.3811770677566528,
            0.08776549249887466,
            0.11431580036878586,
            0.5583775639533997,
            -0.9995988607406616,
            0.3315870761871338,
            0.5323910713195801,
            0.25355562567710876,
            0.16927091777324677,
            -0.3758951425552368,
            0.5819927453994751,
            -0.20898091793060303,
            -0.021029217168688774,
            0.5509864091873169,
            -0.8276509642601013],
        [   -1.299303650856018,
            -0.9196970462799072,
            0.0832303911447525,
            0.25186997652053833,
            -0.0504613034427166,
            -1.1153508424758911,
            -0.06465369462966919,
            -1.8805875778198242,
            0.4275974631309509,
            -0.10452057421207428,
            -0.2722221910953522,
            -0.05892142653465271,
            -0.3192943334579468,
            0.168181911110878,
            -0.30939388275146484,
            0.06865821033716202],
        [   0.5848768949508667,
            2.7181894779205322,
            -0.3899422287940979,
            0.45029112696647644,
            -0.8245608806610107,
            2.079617977142334,
            -0.020155804231762886,
            0.750194251537323,
            0.11306953430175781,
            1.926959753036499,
            -0.1952400803565979,
            -0.883053719997406,
            -0.471640020608902,
            -0.07017997652292252,
            1.8204309940338135,
            -1.9611916542053223],
        [   -0.5798115730285645,
            -1.8186999559402466,
            0.01687503792345524,
            0.5446739792823792,
            0.45775073766708374,
            0.8571390509605408,
            -0.25449633598327637,
            -1.1839001178741455,
            0.9256559014320374,
            1.8879145383834839,
            -0.3248469829559326,
            -0.33993858098983765,
            -0.7912431955337524,
            1.1640384197235107,
            -1.9057681560516357,
            -0.4807642102241516],
        [   -2.6979541778564453,
            1.005304217338562,
            -0.13215205073356628,
            0.1767013520002365,
            -0.06160586699843407,
            3.0005650520324707,
            -0.002826177515089512,
            -2.4669389724731445,
            -0.14679016172885895,
            2.4768333435058594,
            -0.04405561089515686,
            -0.9752740859985352,
            0.05270721763372421,
            -0.10948172956705093,
            -0.6879323720932007,
            -1.8595794439315796],
        [   -0.7337688207626343,
            -0.4234168827533722,
            -0.06573160737752914,
            -0.007924960926175117,
            -0.5890359878540039,
            1.4717413187026978,
            -0.2639029324054718,
            -0.6834954619407654,
            0.4815389811992645,
            0.373209685087204,
            0.22476305067539215,
            -1.724726676940918,
            0.1952594369649887,
            0.2092384696006775,
            -0.9493531584739685,
            0.5590254664421082],
        [   0.416579008102417,
            2.4975032806396484,
            -0.19657593965530396,
            0.08246297389268875,
            -0.513388454914093,
            -0.060513220727443695,
            -0.34079861640930176,
            0.7184401154518127,
            -0.4374203383922577,
            -0.9569195508956909,
            -0.036107975989580154,
            -0.03894238919019699,
            -0.35860776901245117,
            -0.13222379982471466,
            1.7204447984695435,
            -0.4537654221057892],
        [   -1.1473268270492554,
            0.1253223568201065,
            0.018434984609484673,
            0.11991935223340988,
            -1.192375898361206,
            0.7452095746994019,
            -1.0518049001693726,
            -1.1020640134811401,
            -0.7013170123100281,
            1.2516034841537476,
            -0.36876410245895386,
            -2.8938546180725098,
            0.016729868948459625,
            0.031797077506780624,
            0.4905872344970703,
            -0.5118138790130615],
        [   -0.1842276006937027,
            -0.8123275637626648,
            -0.40272802114486694,
            1.6778922080993652,
            0.4087675213813782,
            3.3221323490142822,
            0.11618521809577942,
            0.3300839364528656,
            0.4152471721172333,
            1.872725009918213,
            -0.12594082951545715,
            0.0986587181687355,
            0.1469351202249527,
            1.6498351097106934,
            -0.35918498039245605,
            -0.5291271209716797],
        [   -0.7561023831367493,
            0.688398540019989,
            -0.1747353971004486,
            0.26731765270233154,
            0.3432720899581909,
            0.674545407295227,
            0.5616023540496826,
            -1.1606576442718506,
            -0.5479860901832581,
            1.7251077890396118,
            -0.3370530307292938,
            1.5935454368591309,
            -0.0429077073931694,
            0.7794498801231384,
            0.35382723808288574,
            -0.0649702399969101],
        [   0.0433514304459095,
            -0.7226078510284424,
            -0.3902494013309479,
            0.3428061306476593,
            -1.0275121927261353,
            0.9611713886260986,
            -0.16245993971824646,
            -0.30691877007484436,
            0.9542111158370972,
            0.04725843295454979,
            -0.30477890372276306,
            -0.8911198973655701,
            -0.5078692436218262,
            -0.1304536759853363,
            -0.39595484733581543,
            -0.10249112546443939],
        [   -1.7570065259933472,
            0.994955837726593,
            -0.4759655296802521,
            -0.0917142704129219,
            -0.5405516624450684,
            1.6253628730773926,
            -0.05938486009836197,
            -1.3746287822723389,
            0.14807966351509094,
            0.4012196362018585,
            -0.18288974463939667,
            -2.716433525085449,
            -0.4869946241378784,
            0.32244446873664856,
            0.2581062614917755,
            -0.6467434763908386],
        [   -1.163056492805481,
            -1.5943143367767334,
            -0.40206336975097656,
            0.25798431038856506,
            -0.3368057608604431,
            2.2014691829681396,
            -0.5796293616294861,
            -1.2879507541656494,
            0.58799809217453,
            0.6117962002754211,
            0.10353009402751923,
            -0.29711058735847473,
            -0.21583883464336395,
            0.2691020965576172,
            -1.3451387882232666,
            -0.2974400818347931],
        [   2.682310104370117,
            0.398536741733551,
            0.03059139847755432,
            -0.21120339632034302,
            -0.5606743097305298,
            -0.20115695893764496,
            -0.5307223200798035,
            3.1152830123901367,
            1.1555941104888916,
            -2.4511871337890625,
            0.16057275235652924,
            -0.5103855133056641,
            -0.4542841613292694,
            -0.3015553653240204,
            0.4723193049430847,
            -0.17179538309574127],
        [   -0.6055670976638794,
            0.5099489092826843,
            -0.14260578155517578,
            0.10291190445423126,
            0.14978991448879242,
            0.35094398260116577,
            0.3376951217651367,
            -1.432483434677124,
            0.06653454154729843,
            0.6730735898017883,
            -0.2004876285791397,
            0.5914927124977112,
            0.16649243235588074,
            -0.1702638566493988,
            -0.14802981913089752,
            -0.3180627226829529],
        [   -0.20051521062850952,
            -0.9007681608200073,
            0.032354701310396194,
            -0.0025396491400897503,
            -0.8143765926361084,
            1.0805598497390747,
            -0.053086161613464355,
            -0.9390721321105957,
            1.8090260028839111,
            0.2801131308078766,
            0.18990090489387512,
            -0.22945444285869598,
            0.24391575157642365,
            0.26192188262939453,
            -0.3990483582019806,
            0.13818994164466858],
        [   -0.7712917923927307,
            -0.12318658828735352,
            0.2095642387866974,
            1.1359772682189941,
            -1.0190242528915405,
            2.363614797592163,
            0.10186560451984406,
            -0.8153241872787476,
            1.741639256477356,
            1.3917561769485474,
            0.029283616691827774,
            -1.583746075630188,
            0.005603301338851452,
            1.2840163707733154,
            -0.05470362678170204,
            -0.665392279624939],
        [   -1.1361327171325684,
            -1.6464802026748657,
            -0.8668323755264282,
            2.8571314811706543,
            -1.2837493419647217,
            3.9734160900115967,
            -0.8534185886383057,
            -1.3081673383712769,
            0.38726937770843506,
            2.9367780685424805,
            -0.17548522353172302,
            -2.7254514694213867,
            0.08708690106868744,
            2.409841299057007,
            -1.5792901515960693,
            -0.8826507329940796],
        [   0.3795272707939148,
            -0.8442308902740479,
            -0.23053030669689178,
            -0.010048486292362213,
            0.44109538197517395,
            0.7396774888038635,
            0.04235659912228584,
            0.4803990125656128,
            0.20013554394245148,
            0.3220733404159546,
            -0.08292046189308167,
            0.6014561057090759,
            -1.1910697221755981,
            0.2204544097185135,
            -0.36211755871772766,
            -0.8023291826248169],
        [   -1.6698116064071655,
            -0.37509316205978394,
            -0.42362064123153687,
            0.15266253054141998,
            -0.9194470047950745,
            2.0641098022460938,
            -0.39053475856781006,
            -1.9645380973815918,
            1.0069093704223633,
            0.49804502725601196,
            -0.0934457778930664,
            -0.37741515040397644,
            -0.15158037841320038,
            0.07063701003789902,
            -0.24768099188804626,
            0.4186190962791443],
        [   -0.2782721519470215,
            -2.254988670349121,
            -0.5400532484054565,
            0.2225072979927063,
            0.051511771976947784,
            -0.5713115930557251,
            -0.3725738227367401,
            -0.07309673726558685,
            -0.7839686870574951,
            -0.5610960125923157,
            -0.03752734512090683,
            -0.8781743049621582,
            -5.608063220977783,
            -0.06665320694446564,
            -1.784731149673462,
            -0.16632701456546783],
        [   -1.2388429641723633,
            0.2355511635541916,
            -0.4043571352958679,
            1.7300658226013184,
            -0.851473867893219,
            4.331344127655029,
            -0.3934147357940674,
            -0.4541550874710083,
            1.7908533811569214,
            2.601637125015259,
            0.21824952960014343,
            -0.8398531079292297,
            -0.15579664707183838,
            1.6021075248718262,
            -0.38707947731018066,
            -0.9198434352874756],
        [   0.4326132833957672,
            1.0646804571151733,
            0.5959131121635437,
            0.03882283717393875,
            1.2585910558700562,
            -0.5444968938827515,
            0.37463271617889404,
            0.5384778380393982,
            0.6029844284057617,
            -0.6649181842803955,
            -0.2213663011789322,
            0.5561186671257019,
            0.006659259088337421,
            0.1168690025806427,
            0.9374157190322876,
            0.37153175473213196],
        [   -0.47849878668785095,
            -1.2927765846252441,
            -0.4583621621131897,
            2.1960456371307373,
            -0.9936631917953491,
            4.3382697105407715,
            -0.23200108110904694,
            -0.7116275429725647,
            2.4492204189300537,
            2.552443504333496,
            -0.04636355862021446,
            -1.395975947380066,
            -0.030748775228857994,
            2.4123330116271973,
            -0.9961997866630554,
            -0.9838870167732239],
        [   0.5541509985923767,
            -0.2752261161804199,
            -0.40498441457748413,
            0.5005127191543579,
            0.10352054983377457,
            0.021696802228689194,
            -0.09582845121622086,
            1.307438850402832,
            0.4460603594779968,
            0.5920040011405945,
            -0.24126878380775452,
            -0.025077905505895615,
            -0.012561232782900333,
            0.6265900135040283,
            0.84160315990448,
            0.07916538417339325]],
    [   -0.6022242903709412,
        -0.3425270915031433,
        -0.5248614549636841,
        1.3607803583145142,
        -0.35886579751968384,
        -0.12925513088703156,
        0.027341676875948906,
        -0.46688270568847656,
        -0.2885388433933258,
        0.5878937244415283,
        -0.1721969097852707,
        0.1429872363805771,
        0.18568235635757446,
        1.2188578844070435,
        -0.5737525224685669,
        -0.11951678991317749],
    [   [0.0014212012756615877],
        [1.182570219039917],
        [0.15897387266159058],
        [-0.39005425572395325],
        [0.5729678273200989],
        [-0.7694132924079895],
        [0.37192168831825256],
        [0.6958343386650085],
        [-0.45903873443603516],
        [-0.28287971019744873],
        [0.2835789620876312],
        [0.650177538394928],
        [1.6018437147140503],
        [-0.11370718479156494],
        [0.140239879488945],
        [0.27911368012428284]],
    [-1.4479135274887085]]



### train.py


import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import pandas as pd
import tensorflow as tf
from sklearn.metrics import classification_report

df.drop(columns=['pr','src_ip', 'dst_ip', 'src_pt', 'dst_pt', 'cnt','bts', 'flgs'], inplace=True)

df = pd.get_dummies(df, columns=['dst_subnet'], drop_first=True)

# Separate features and target

X = df


# Preprocess the features
scaler = StandardScaler()
X = scaler.fit_transform(X)


# Define the model
model = Sequential()
model.add(Dense(32, input_dim=X.shape[1], activation='relu'))  # Input layer
model.add(Dense(16, activation='relu'))  # Hidden layer
model.add(Dense(1, activation='sigmoid'))  # Output layer

weights = [np.array(w) for w in weights]
model.set_weights(weights)


# Make predictions on the new DataFrame
y_pred_new = model.predict(X)
y_pred_new = (y_pred_new > 0.5)

# Print the predictions
# print(y_pred_new)
# Convert the predictions to a pandas Series
y_pred_new_series = pd.Series(y_pred_new.flatten())

# Print the value counts
for i in y_pred_new:
    if i == True:
        print('TRUE', flush=True)
    else:
        print('FALSE', flush=True)

